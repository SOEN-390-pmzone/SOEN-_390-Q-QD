<!DOCTYPE html>
<html>
<head>
    <title>SVG Coordinate Extractor</title>
    <style>
        body { margin: 0; overflow: auto; }
        #container { position: relative; }
        #output { 
            position: fixed; 
            top: 10px; 
            left: 10px; 
            background: rgba(255,255,255,0.8); 
            padding: 10px; 
            z-index: 100;
            max-width: 300px;
        }
        #jsonOutput { width: 100%; height: 200px; }
        #svgContainer { width: 100%; }
    </style>
</head>
<body>
    <div id="container">
        <div id="output">
            <p>Click on a room, then its door/nearest point</p>
            <p>X: <span id="x">0</span>, Y: <span id="y">0</span></p>
            <button id="addRoom">Add Room</button>
            <button id="addDoor">Add Door</button>
            <button id="clear">Clear</button>
            <textarea id="jsonOutput"></textarea>
        </div>
        
        <div id="svgContainer">
            <!-- Replace with your SVG file -->
            <object id="svgObject" type="image/svg+xml" data="../../assets/svg/VL-2.svg" width="100%"></object>
        </div>
    </div>

    <script>
        let currentRoom = null;
        let roomData = {};
        
        document.getElementById('svgObject').addEventListener('load', function() {
            const svgDoc = this.contentDocument;
            svgDoc.addEventListener('click', function(e) {
                // Get coordinates relative to the SVG, accounting for scroll position
                const svgRect = document.getElementById('svgObject').getBoundingClientRect();
                const scrollX = window.pageXOffset || document.documentElement.scrollLeft;
                const scrollY = window.pageYOffset || document.documentElement.scrollTop;
                
                const x = Math.round(e.clientX - svgRect.left + scrollX);
                const y = Math.round(e.clientY - svgRect.top + scrollY);
                
                document.getElementById('x').textContent = x;
                document.getElementById('y').textContent = y;
            });
        });
        
        document.getElementById('addRoom').addEventListener('click', function() {
            const roomName = prompt("Enter room name:");
            if (!roomName) return;
            
            currentRoom = roomName;
            const x = document.getElementById('x').textContent;
            const y = document.getElementById('y').textContent;
            
            roomData[roomName] = {
                x: x,
                y: y,
                nearestPoint: {}
            };
            
            updateOutput();
        });
        
        document.getElementById('addDoor').addEventListener('click', function() {
            if (!currentRoom) {
                alert("Please select a room first");
                return;
            }
            
            const x = document.getElementById('x').textContent;
            const y = document.getElementById('y').textContent;
            
            roomData[currentRoom].nearestPoint = {
                x: x,
                y: y
            };
            
            currentRoom = null;
            updateOutput();
        });
        
        document.getElementById('clear').addEventListener('click', function() {
            roomData = {};
            updateOutput();
        });
        
        function updateOutput() {
            document.getElementById('jsonOutput').value = JSON.stringify(roomData, null, 4);
        }
    </script>
</body>
</html>